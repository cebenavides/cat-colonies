{"changed":true,"filter":false,"title":"tasks_controller.rb","tooltip":"/app/controllers/tasks_controller.rb","value":"class TasksController < ApplicationController\n  before_action :auth_user\n  before_action :verify_is_admin, only: [:new]\n  before_action :set_task, only: [:show, :edit, :update, :destroy]\n\n  # GET /tasks\n  # GET /tasks.json\n  def index\n    if current_user.admin?\n      @tasks = Task.all\n    else\n      @tasks = current_user.tasks\n    end\n  end\n\n  # GET /tasks/new\n  def new\n    @task = Task.new\n  end\n\n  # POST /tasks\n  # POST /tasks.json\n  def create\n    @task = Task.new(task_params)\n\n    respond_to do |format|\n      if @task.save\n        format.html { redirect_to tasks_path, notice: 'Task was successfully created.' }\n        format.json { render :show, status: :created, location: @task }\n      else\n        format.html { render :new }\n        format.json { render json: @task.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n  \n  # DELETE /tasks/1\n  # DELETE /tasks/1.json\n  def destroy\n    @task.destroy\n    respond_to do |format|\n      format.html { redirect_to tasks_url, notice: 'Task was successfully deleted.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_task\n      @task = Task.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def task_params\n      params.require(:task).permit(:title, :description, :start_date, :user_id)\n    end\n    \n    def verify_is_admin\n      (current_user.nil?) ? redirect_to(root_path) : (redirect_to(root_path, notice: \"You're not authorized to enter here.\") unless current_user.admin?)\n    end\n    \n    def auth_user\n      redirect_to root_path unless current_user\n    end\nend\n","undoManager":{"mark":-2,"position":27,"stack":[[{"start":{"row":0,"column":45},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":799},{"start":{"row":1,"column":0},"end":{"row":1,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":59,"column":7},"end":{"row":60,"column":0},"action":"insert","lines":["",""],"id":800},{"start":{"row":60,"column":0},"end":{"row":60,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":60,"column":4},"end":{"row":61,"column":0},"action":"insert","lines":["",""],"id":801},{"start":{"row":61,"column":0},"end":{"row":61,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":61,"column":4},"end":{"row":63,"column":7},"action":"insert","lines":["def auth_user","      redirect_to root_path unless current_user","    end"],"id":802}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"insert","lines":["b"],"id":803}],[{"start":{"row":1,"column":3},"end":{"row":1,"column":4},"action":"insert","lines":["e"],"id":804}],[{"start":{"row":1,"column":4},"end":{"row":1,"column":5},"action":"insert","lines":["f"],"id":805}],[{"start":{"row":1,"column":5},"end":{"row":1,"column":6},"action":"insert","lines":["o"],"id":806}],[{"start":{"row":1,"column":6},"end":{"row":1,"column":7},"action":"insert","lines":["r"],"id":807}],[{"start":{"row":1,"column":7},"end":{"row":1,"column":8},"action":"insert","lines":["e"],"id":808}],[{"start":{"row":1,"column":8},"end":{"row":1,"column":9},"action":"insert","lines":["_"],"id":809}],[{"start":{"row":1,"column":9},"end":{"row":1,"column":10},"action":"insert","lines":["a"],"id":810}],[{"start":{"row":1,"column":10},"end":{"row":1,"column":11},"action":"insert","lines":["c"],"id":811}],[{"start":{"row":1,"column":11},"end":{"row":1,"column":12},"action":"insert","lines":["i"],"id":812}],[{"start":{"row":1,"column":11},"end":{"row":1,"column":12},"action":"remove","lines":["i"],"id":813}],[{"start":{"row":1,"column":11},"end":{"row":1,"column":12},"action":"insert","lines":["t"],"id":814}],[{"start":{"row":1,"column":12},"end":{"row":1,"column":13},"action":"insert","lines":["i"],"id":815}],[{"start":{"row":1,"column":13},"end":{"row":1,"column":14},"action":"insert","lines":["o"],"id":816}],[{"start":{"row":1,"column":14},"end":{"row":1,"column":15},"action":"insert","lines":["n"],"id":817}],[{"start":{"row":1,"column":15},"end":{"row":1,"column":16},"action":"insert","lines":[" "],"id":818}],[{"start":{"row":1,"column":16},"end":{"row":1,"column":17},"action":"insert","lines":[":"],"id":819}],[{"start":{"row":1,"column":17},"end":{"row":1,"column":18},"action":"insert","lines":["a"],"id":820}],[{"start":{"row":1,"column":18},"end":{"row":1,"column":19},"action":"insert","lines":["u"],"id":821}],[{"start":{"row":1,"column":19},"end":{"row":1,"column":20},"action":"insert","lines":["t"],"id":822}],[{"start":{"row":1,"column":20},"end":{"row":1,"column":21},"action":"insert","lines":["h"],"id":823}],[{"start":{"row":1,"column":17},"end":{"row":1,"column":21},"action":"remove","lines":["auth"],"id":824},{"start":{"row":1,"column":17},"end":{"row":2,"column":2},"action":"insert","lines":["auth_user","  "]}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":2},"action":"remove","lines":["  "],"id":825}],[{"start":{"row":1,"column":26},"end":{"row":2,"column":0},"action":"remove","lines":["",""],"id":826}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":8,"column":26},"end":{"row":8,"column":26},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":16,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1495570043437}